<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>Web登录系统SQL注入实例</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 10px;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            font-size: 16px;
        }
        .form-group input[type="submit"] {
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
        }
        .form-group input[type="submit"]:hover {
            background-color: #45a049;
        }
        .btn {
            display: inline-block;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            margin-top: 20px;
        }
        .btn:hover {
            background-color: #45a049;
        }
		.error {
		color: red;
		margin-left: 10px;
		}
    </style>
</head>
<body>
	<div class="container">
        <form name="LOGIN_FORM" method="post" action="">
            <div class="form-group">
                <label for="username">登录帐号:</label>
                <input type="text" id="username" name="username">
            </div>
            <div class="form-group">
                <label for="password">登录密码:</label>
                <input type="password" id="password" name="password">
            </div>
			<span id="passwordError" class="error"></span>
            <div class="form-group">
                <input type="submit" value="登录">
            </div>
        </form>
    </div>
    <?php 
	session_start();

   if($_POST){
    $conn = mysqli_connect("localhost", "zenghao", "03210830", "sq1x5s");
    $username = empty($_POST['username']) ? '' : $_POST['username'];
    $password = empty($_POST['password']) ? '' : $_POST['password'];
    $md5password = md5($password);
    // $sql = "SELECT uid , username , password FROM user WHERE username='{$username}' AND password='{$md5password}'";
    $sql = "SELECT * FROM user WHERE username='$username' AND password='$md5password'";

    $query = mysqli_query($conn, $sql);
    $userinfo = mysqli_fetch_array($query, MYSQLI_ASSOC);
	// 登录成功，表格形式出所有查询到的会员信息，否则输出用户名不存在或密码错误！
	if(!empty($userinfo)){
		$_SESSION['user_id'] = $userinfo['uid'];
		header('Location: home.php');
		exit;
        echo '<table border="1" cellspacing="0" cellpadding="0" width="80%" align="center">';
		echo '<caption><h1>用户信息列表</h1></caption>';
		echo '<tr><td>用户名</td><td>密码</td></tr>';
        while ($array=mysqli_fetch_array($query)) {
			echo "<tr>";
			echo "<td>".$array["username"]."</td>";
			echo "<td>".$array["password"]."</td>";
			echo "</tr>";
		}    
		echo '</table>';
	} else {
		echo "<script>document.getElementById('passwordError').textContent = '用户名不存在或密码错误！';</script>";	}
}
?>
</body>
</html>